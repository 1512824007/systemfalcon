{% extends "view/Base3.html" %}
{% block content %}
<ul  class="nav nav-tabs">
                <li role="presentation"><a href="/monitor/Dashboard/">dashboard</a></li>
                <li role="presentation" class="active"><a href="/monitor/MonitorInfo/">监控信息</a></li>
                <li role="presentation"><a href="/monitor/MonitorManage/">系统配置</a></li>
                <li role="presentation"><a href="#">资源管理</a></li>
                <li role="presentation"><a href="#">变更管理</a></li>
                <li role="presentation"><a href="/monitor/sysconf/user_manage/">用户管理</a></li>
                <li role="presentation"><a href="#">安全检测</a></li>
                <li role="presentation"><a href="#">FAQ</a></li>
</ul>
<link href="/static/css/bootstrap-datetimepicker.css" rel="stylesheet"/>
<link rel="stylesheet" href="/static/public/plugin/Chosen/chosen.min.css">
<script src="/static/public/plugin/Chosen/chosen.jquery.min.js"></script>
<script src="/static/public/js/common.js"></script>
<script type="text/javascript" src="/static/js/bootstrap-datetimepicker.js" charset="UTF-8"></script>
<script type="text/javascript" src="/static/js/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>

<div class="Content">
    <h4 style="color: #1a78b5;padding: 0 5px;margin: 0;font-size:16px;">全网带宽<a class="backMonitor">返回</a></h4>
    <div class="row" style="padding:15px 0">
        <div class="col-xs-12">
            <div class="dashboardItem">
                <div class="dashboardItemContent">
                    <div style="width:auto;height:auto;">
                        <iframe  src="/monitor/hcgraph/index/chart/network/" width="100%" height="500px"
                                            scrolling="no" frameborder="0"></iframe>
                    </div>
                </div>
            </div>
        </div>
        <div class="row rmt20">
            <div class="col-xs-12">
                <div class="dashboardItem">
                    <div class="dashboardItemTitle">
                        <span>机房带宽TOP10-直播</span>
                    </div>
                    <div class="dashboardItemContent">
                        <table class="table table-hover text-center">
                            <thead>
                                <th class="text-center">TOP</th>
                                <th class="text-center">机房名称</th>
                                <th class="text-center">总带宽(Mbps)</th>
                                <th class="text-center">当前使用带宽(Mbps)</th>
                                <th class="text-center">使用率</th>
                            </thead>
                            <tbody>
                            {% for en_co in live_nic %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>
                                    {% for each_1 in room_all %}
                                    {% if en_co.0 == each_1.abbr_name %}
                                    <a href="/monitor/MonitorInfo/ServerRoom/Detail/{{ each_1.name }}"
                                       target="_blank">{{ each_1.name }}</a>
                                    {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {{ en_co.1 }}
                                </td>
                                <td> {{ en_co.2 }} </td>
                                <td>
                                    {{ en_co.3 }}
                                </td>
                            </tr>
                            {% endfor %}
                            </tbody>
                            <!--<thead >
                            <th class="text-center">TOP</th>
                            <th class="text-center">机房名</th>
                            <th class="text-center">当前带宽</th>
                            </thead>
                            <tbody>
                             {% for each in ss_clms %}
                                 <tr>
                                   <td>{{ forloop.counter }}</td>
                                   <td>
                                     {% for each_1 in room_all %}
                                         {% if each_1.abbr_name == each.idc %}
                     <a href="/monitor/MonitorInfo/ServerRoom/Detail/{{ each_1.name }}">{{ each_1.name }}</a>
                                         {% endif %}
                                       {% endfor %}
                                   </td>
                                   <td>{{ each.total_ssvalue }}</td>
                                   <td>
                                 </tr>
                             {% endfor %}


                            </tbody>-->
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="row rmt20">
            <div class="col-xs-12">
                <div class="dashboardItem">
                    <div class="dashboardItemTitle">
                        <span>机房带宽TOP10-点播</span>
                    </div>
                    <div class="dashboardItemContent">
                        <table class="table table-hover text-center">
                            <thead >
                            <th class="text-center">TOP</th>
                            <th class="text-center">机房名</th>
                            <th class="text-center">当前并发请求数</th>
                            </thead>
                            <tbody>
                             {% for each in ss_vod %}
                                 <tr>
                                   <td>{{ forloop.counter }}</td>
                                   <td>
                                     {% for each_1 in room_all %}
                                         {% if each_1.abbr_name == each.idc %}
                                            <a href="/monitor/MonitorInfo/ServerRoom/Detail/{{ each_1.name }}">{{ each_1.name }}</a>
                                         {% endif %}
                                       {% endfor %}
                                   </td>
                                   <td>{{ each.total_ssvalue }}</td>

                                 </tr>
                             {% endfor %}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>-->
        <div class="row rmt20">
            <div class="col-xs-12">
                <div class="dashboardItem">
                    <div class="dashboardItemTitle">
                        <span>机房带宽TOP10-页面</span>
                    </div>
                    <div class="dashboardItemContent">
                        <table class="table table-hover text-center">
                        <thead>
                                    <th class="text-center">TOP</th>
                                    <th class="text-center">机房名称</th>
                                    <th class="text-center">总带宽(Mbps)</th>
                                    <th class="text-center">当前使用带宽(Mbps)</th>
                                    <th class="text-center">使用率</th>
                                </thead>
                                <tbody>
                                {% for en_co in web_nic %}
                                    <tr>
                                        <td>{{ forloop.counter }}</td>
                                        <td>
                                            {% for each_1 in room_all %}
                                                {% if en_co.0 == each_1.abbr_name %}
                                                    <a href="/monitor/MonitorInfo/ServerRoom/Detail/{{ each_1.name }}"
                                                    target="_blank">{{ each_1.name }}</a>
                                                {% endif %}
                                            {% endfor %}
                                        </td>
                                        <td>
                                            {{ en_co.1 }}
                                        </td>
                                        <td> {{ en_co.2 }} </td>
                                        <td>
                                            {{ en_co.3 }}
                                        </td>
                                    </tr>
                                {% endfor %}

                                </tbody>

                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="row rmt20">
            <div class="col-xs-12">
                <div class="dashboardItem">
                    <div class="dashboardItemTitle">
                        <span>机房带宽TOP10-下载</span>
                    </div>
                    <div class="dashboardItemContent">
                        <table class="table table-hover text-center">
                            <thead >
                            <th class="text-center">TOP</th>
                            <th class="text-center">机房名</th>
                            <th class="text-center">当前并发请求数</th>
                            </thead>
                            <tbody>
                            <tr>
                                <td>1</td>
                                <td><a href="">北京电信兆维BGP机房</a></td>
                                <td>22</td>
                            </tr>


                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>-->
        <h4 style="color: #1a78b5;padding: 0 30px;margin:20px 0 0 0;font-size:16px;">机房带宽查询</h4>
        <div class="row rmt20 monitorInfoBox" style="padding:0 20px;" >
            <div class="dashboardItem" style="min-height: 0!important;" >
                <div class="dashboardItemContent" >
                    <div class="row rmt30" style="height: 60px;">
                        <div class="col-xs-2 chosenSelect">
                            <label for=""  class="col-xs-5 text-right" style="padding-top: 5px;">机房:</label>
                            <select name="idc"  class="col-xs-6" id="2">
                                {% for i in room_all %}
                                <option value={{ i.name }}>{{ i.name }}</option>
                                {% endfor %}
                            </select>

                        </div>
                        <div class="col-xs-2 chosenSelect">
                            <label for="" class="col-xs-5 text-right" style="padding-top: 5px;">监控设备组:</label>
                            <select name="project" class="col-xs-6" id="1">
                                {% for i in grp %}
                                <option value={{ i.0 }}>{{ i.0 }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-xs-3">
                            <label for="" class="col-xs-6 text-right" style="padding-top: 5px;">开始时间:</label>
                            <input id="begin" size="16" type="text" value="" readonly class="form_datetime">
                        </div>
                        <div class="col-xs-3">
                            <label for="" class="col-xs-6 text-right" style="padding-top: 5px;">结束时间:</label>
                            <input id="over"  type="text" value="" readonly class="form_datetime">
                            <script type="text/javascript">
                                $(".form_datetime").datetimepicker({format: 'yyyy-mm-dd hh:ii',autoclose: true,
                                    todayBtn: true,
                                    todayHighlight: true,
                                    pickerPosition: "bottom-left",
                                    language: 'zh-CN'});
                            </script>
                        </div>
                        <div class="col-xs-2 text-center">

                            <a onclick="redirect()" class="btn btn-primary">查询</a><a href="" class="btn">重置</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="width:auto;height:auto;">
            <iframe id ="3" style="display:none" frameborder="0"></iframe>
        </div>
    </div>
</div>
<script>
function redirect() {
    var idc_search=document.getElementById(2);
    var index = idc_search.selectedIndex;
    var value = idc_search.options[index].value;

    var pro_search=document.getElementById(1);
    var p_index = pro_search.selectedIndex;
    var p_value = pro_search.options[p_index].value;

    var b_search =document.getElementById('begin');
    var str_1 = b_search.value;
    str_1 = str_1.replace(/-/g,"/");
    var date_1 = new Date(str_1);
    var humanDate_1 = new Date(Date.UTC(date_1.getFullYear(),date_1.getMonth(),
    date_1.getDate(),date_1.getHours(),date_1.getMinutes(), date_1.getSeconds()));
    begin = humanDate_1.getTime()/1000 - 8*60*60;

    var o_search =document.getElementById('over');
    var str = o_search.value;
    str = str.replace(/-/g,"/");
    var date = new Date(str);
    var humanDate = new Date(Date.UTC(date.getFullYear(),date.getMonth(),
    date.getDate(),date.getHours(),date.getMinutes(), date.getSeconds()));
    over = humanDate.getTime()/1000 - 8*60*60;
    if(str == ''){
        var timestamp = Date.parse(new Date())/1000;
        over = timestamp
    }

    if(str_1 == ''){
        begin = over - 18000
    }

    var obj = document.getElementById(3);
    obj.src = "/monitor/top10/band/?start="+begin+"&end="+over +"&grp="+p_value +"&roomname="+value;

    obj.style='width:100%;height:600px';
    console.log(obj.src)
}
</script>
{% endblock %}